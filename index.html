<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
    <link href="./assets/style.css" rel="stylesheet">
  </head>
  <body>
    <main class="canvas">
      <canvas id="canvas"></canvas>
      <button class="config" onclick="dlgOpen('config')">
        <svg class="icon"><use href="./assets/icons.svg#gear"></use></svg>
      </button>
      <button class="info" onclick="dlgOpen('info')">
        <svg class="icon"><use href="./assets/icons.svg#info-circle"></use></svg>
      </button>
      <button class="match" onclick="dlgOpen('match')">
        <svg class="icon"><use href="./assets/icons.svg#play-circle"></use></svg>
      </button>
      <button class="user" onclick="dlgOpen('user')">
        <svg class="icon"><use href="./assets/icons.svg#person-circle"></use></svg>
      </button>
    </main>
    <dialog id="dlg-match">
      <button class="close" onclick="dlgClose(this)">x</button>
      <h1>Partida</h1>
    </dialog>
    <dialog id="dlg-info">
      <button class="close" onclick="dlgClose(this)">x</button>
      <h1>Información</h1>
      <div></div>
    </dialog>
    <dialog id="dlg-config">
      <button class="close" onclick="dlgClose(this)">x</button>
      <h1>Configuración</h1>
    </dialog>
    <dialog id="dlg-user">
      <button class="close" onclick="dlgClose(this)">x</button>
      <h1>Usuario</h1>
    </dialog>
    <script type="module">
      import App from './assets/index.js';
      const res = await fetch(`./assets/lang.${localStorage.getItem('lang')??'es'}.json`);
      const lang = await res.json();
      const app = new App('canvas');
      window.dlgOpen = id=>{
        const dlg = document.getElementById('dlg-' + id);
        dlg.showModal();
        if (window['fn'+id]) window['fn'+id](dlg);
      };
      window.dlgClose = e=>e.parentNode.close();
      window.fninfo = it=>{
        const selected = app.global.selected??{};
        const views = it.querySelectorAll('h1,div');
        const info = lang[`info-${selected.x??''}${selected.y??''}`]??Lang['info-'];
        views[0].innerHTML = info[0];
        views[1].innerHTML = info[1];
      };
    </script>
  </body>
</html>
